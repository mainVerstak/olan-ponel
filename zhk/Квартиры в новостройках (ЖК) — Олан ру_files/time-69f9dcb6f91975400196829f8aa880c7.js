(function(){define("time_utils",["jquery","livequery"],function(n){var a,u,s,i,o,c,g,f,r,l,D,m;f=["\u044f\u043d\u0432","\u0444\u0435\u0432","\u043c\u0430\u0440","\u0430\u043f\u0440","\u043c\u0430\u0439","\u0438\u044e\u043d","\u0438\u044e\u043b","\u0430\u0432\u0433","\u0441\u0435\u043d","\u043e\u043a\u0442","\u043d\u043e\u044f","\u0434\u0435\u043a"],i=function(e,t){return t[4<e%100&&e%100<20?2:[2,0,1,1,1,2][e%10<5?e%10:5]]},D=function(){var e,t,n;return t=new Date,n=(e=new Date(t.getFullYear(),0,1,0,0,0,0)).toGMTString(),(e-new Date(n.substring(0,n.lastIndexOf(" ")-1)))/36e5},s=function(e){var t,n,r;return n=/^([0-9]{4})-([0-9]{2})-([0-9]{2})[T\s]([0-9]{2}):([0-9]{2}):([0-9]{2})/.exec(e.attr("datetime")),t=new Date(parseInt(n[1]),parseInt(n[2])-1,parseInt(n[3]),parseInt(n[4]),parseInt(n[5]),parseInt(n[6])),r=60*(-3+(e.attr("time_zone")?parseInt(e.attr("time_zone")):D()))*60*1e3,t.setTime(t.getTime()+r),t},a=function(){return(new Date).getTime()},l=function(e){return s(e).getTime()},m=function(e){var t,n,r;return((t=(r=s(e)).getHours())<10?"0"+t:t)+":"+((n=r.getMinutes())<10?"0"+n:n)},u=function(e){var t,n,r,a,u,i,o;return t=(o=s(e)).getDate(),i=o.getMonth(),r=(n=o.getHours())<10?"0"+n:n,u=(a=o.getMinutes())<10?"0"+a:a,t+" "+f[i]+" \u0432 "+r+":"+u},c=function(e){var t,n;return n=s(e),t=new Date,n.getYear()===t.getYear()&&n.getMonth()===t.getMonth()&&n.getDate()===t.getDate()},g=function(e){var t,n;return n=s(e),t=new Date((new Date).setDate((new Date).getDate()-1)),n.getYear()===t.getYear()&&n.getMonth()===t.getMonth()&&n.getDate()===t.getDate()},o=function(e){var t,n,r;return n=s(e),t=new Date,r=Math.abs(t.getTime()-n.getTime()),365<Math.ceil(r/864e5)},r=function(e){var t,n,r;n=(a()-l(e))/1e3,t=Boolean(e.attr("future")),r=function(){switch(!1){case!(n<0&&t):return u(e);case!(n<60):return"\u0442\u043e\u043b\u044c\u043a\u043e \u0447\u0442\u043e";case!(n<120):return"\u043c\u0438\u043d\u0443\u0442\u0443 \u043d\u0430\u0437\u0430\u0434";case!(n<=3540):return Math.round(n/60)+" "+i(Math.round(n/60),["\u043c\u0438\u043d\u0443\u0442\u0443 \u043d\u0430\u0437\u0430\u0434","\u043c\u0438\u043d\u0443\u0442\u044b \u043d\u0430\u0437\u0430\u0434","\u043c\u0438\u043d\u0443\u0442 \u043d\u0430\u0437\u0430\u0434"]);case!c(e):return"\u0441\u0435\u0433\u043e\u0434\u043d\u044f \u0432 "+m(e);case!g(e):return"\u0432\u0447\u0435\u0440\u0430 \u0432 "+m(e);case!o(e):return"\u0431\u043e\u043b\u044c\u0448\u0435 \u0433\u043e\u0434\u0430 \u043d\u0430\u0437\u0430\u0434";default:return u(e)}}(),e.text(r)},n("time.smart_time[datetime]").livequery(function(){var e,t;return e=n(this),r(e),t=null,t=setInterval(function(){if(r(e),0===e.length&&t)return clearTimeout(t),t=null},6e4),e.on("refresh-time",function(){return r(e)})})})}).call(this);